# vscode-office ä¸ Folder-Site èåˆèƒ½åŠ›æ‘˜è¦

## ğŸ¯ æ ¸å¿ƒç†å¿µ

å°† **cweijan/vscode-office** çš„ Office æ–‡æ¡£æŸ¥çœ‹èƒ½åŠ›é€šè¿‡**æ’ä»¶åŒ–æ¶æ„**é›†æˆåˆ° **Folder-Site**ï¼Œå®ç°æ‰©å±•æ€§å’Œæ¨¡å—åŒ–çš„å¹³è¡¡ã€‚

---

## ğŸ“‹ æ”¯æŒçš„æ–‡æ¡£ç±»å‹å¯¹æ¯”

| èƒ½åŠ› | vscode-office | Folder-Site é›†æˆå |
|-----|---------------|-------------------|
| Excel æŸ¥çœ‹ | âœ… (.xlsx, .xls, .csv, .ods) | âœ… + |
| Excel ç¼–è¾‘ | âœ… | ğŸ”„ Phase 3 |
| Word æŸ¥çœ‹ | âœ… (.docx, .dotx) | âœ… |
| PDF æŸ¥çœ‹ | âœ… (.pdf) | âœ… |
| å‹ç¼©åŒ… | âœ… (.zip, .rar) | âœ… |
| å­—ä½“é¢„è§ˆ | âœ… (.ttf, .otf) | ğŸ”„ P2 |
| Markdown | âœ… (Vditor) | âœ… å·²å®ç° |

---

## ğŸ—ï¸ æ¨èæ–¹æ¡ˆï¼šæ’ä»¶åŒ–æ¶æ„

### æ–¹æ¡ˆä¼˜åŠ¿
- âœ… ç¬¦åˆç°æœ‰æ’ä»¶ç³»ç»Ÿï¼ˆmermaidã€vegaã€graphvizï¼‰
- âœ… ç‹¬ç«‹å¯ç”¨/ç¦ç”¨
- âœ… æ¨¡å—åŒ–ç»´æŠ¤
- âœ… ä¼˜å…ˆçº§å’Œå†²çªæ£€æµ‹
- âœ… ç”Ÿå‘½å‘¨æœŸç®¡ç†

### æ¶æ„ç®€å›¾

```
FileView ç»„ä»¶
    â†“
æ¸²æŸ“å™¨è·¯ç”±å™¨ï¼ˆæ ¹æ®æ‰©å±•åï¼‰
    â†“
æ’ä»¶ç®¡ç†å™¨ â†’ office-renderer æ’ä»¶
    â”œâ”€ ExcelRenderer (SheetJS)
    â”œâ”€ WordRenderer (docxjs)
    â”œâ”€ PDFRenderer (pdf.js)
    â””â”€ ArchiveRenderer (adm-zip)
```

---

## ğŸ“¦ æ ¸å¿ƒä¾èµ–åº“

| åº“ | åŠŸèƒ½ | å¤§å° |
|----|-----|------|
| xlsx | Excel è§£æ | ~500KB |
| docx-preview | Word æ¸²æŸ“ | ~100KB |
| pdfjs-dist | PDF æ¸²æŸ“ | ~500KB |
| adm-zip | ZIP å¤„ç† | ~50KB |

**æ€»è®¡**: ~1.5MB (gzipped: ~500KB)

---

## ğŸš€ å®æ–½è·¯çº¿ï¼ˆ6å‘¨è®¡åˆ’ï¼‰

### Phase 1ï¼ˆç¬¬1å‘¨ï¼‰- åŸºç¡€æ¡†æ¶
- `office-renderer` æ’ä»¶ç»“æ„
- Excel æ¸²æŸ“å™¨ï¼ˆåªè¯»ï¼‰
- æ–‡ä»¶è·¯ç”±é›†æˆ
- åŸºç¡€ç¼“å­˜

### Phase 2-3ï¼ˆç¬¬2-3å‘¨ï¼‰- æ ¸å¿ƒæ¸²æŸ“å™¨
- Wordã€PDFã€å‹ç¼©åŒ…æ¸²æŸ“å™¨
- æ ·å¼é€‚é…å’Œä¸»é¢˜æ”¯æŒ

### Phase 4ï¼ˆç¬¬4å‘¨ï¼‰- é«˜çº§åŠŸèƒ½
- Excel ç¼–è¾‘æ”¯æŒ
- æœç´¢å’Œå¯¼å‡º

### Phase 5ï¼ˆç¬¬5å‘¨ï¼‰- ä¼˜åŒ–å’Œæµ‹è¯•
- æ€§èƒ½ä¼˜åŒ–ã€å¤§æ–‡ä»¶å¤„ç†
- è·¨æµè§ˆå™¨æµ‹è¯•ã€å®‰å…¨å®¡è®¡

### Phase 6ï¼ˆç¬¬6å‘¨ï¼‰- æ–‡æ¡£å’Œå‘å¸ƒ
- ç”¨æˆ·æ–‡æ¡£ã€ç¤ºä¾‹

---

## ğŸ’» ä»£ç ç¤ºä¾‹ï¼šExcel æ¸²æŸ“å™¨

```typescript
// plugins/office-renderer/ExcelRenderer.ts
import * as XLSX from 'xlsx';

export class ExcelRenderer implements RendererPlugin {
  name = 'excel';
  extensions = ['.xlsx', '.xls', '.csv', '.ods'];
  version = '1.0.0';

  async render(content: string): Promise<string> {
    const workbook = XLSX.read(content, { type: 'binary' });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const data = XLSX.utils.sheet_to_json(sheet);

    return this.renderToHTML(data);
  }
}
```

---

## ğŸ”’ å®‰å…¨ç­–ç•¥

- âœ… **XSS é˜²æŠ¤**: DOMPurify æ¸…ç†æ¸²æŸ“çš„ HTML
- âœ… **æ–‡ä»¶é™åˆ¶**: æœ€å¤§ 10MB
- âœ… **ç±»å‹éªŒè¯**: MIME + æ–‡ä»¶æ‰©å±•å + é­”æ•°
- âœ… **CSP ç­–ç•¥**: ä¸¥æ ¼çš„ Content-Security-Policy

---

## ğŸ“Š æ€§èƒ½ç›®æ ‡

| æ–‡ä»¶å¤§å° | æ¸²æŸ“æ—¶é—´ | ä¼˜åŒ–ç­–ç•¥ |
|---------|---------|---------|
| < 1MB | < 1s | ç›´æ¥æ¸²æŸ“ |
| 1-10MB | < 3s | ç¼“å­˜ + åˆ†å— |
| 10-50MB | < 10s | Web Worker + è™šæ‹Ÿæ»šåŠ¨ |

**ç¼“å­˜ç­–ç•¥**: L1 å†…å­˜ (LRU 100MB) + L2 IndexedDB (7å¤©)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | æè¿° |
|-----|------|
| [é›†æˆæ–¹æ¡ˆåˆ†æ](./vscode-office-integration-analysis.md) | å®Œæ•´æŠ€æœ¯åˆ†æï¼ˆ13837å­—ï¼‰ |
| [æ¶æ„è®¾è®¡](./vscode-office-integration-architecture.md) | è¯¦ç»†æ¶æ„å›¾å’Œç»„ä»¶è®¾è®¡ï¼ˆ18201å­—ï¼‰ |
| [å¿«é€Ÿå…¥é—¨](./vscode-office-quickstart.md) | åˆ†æ­¥å®ç°æŒ‡å—ï¼ˆ15613å­—ï¼‰ |
| [åˆ†ææŠ¥å‘Š](./VSCODE_OFFICE_INTEGRATION_REPORT.md) | æ€»ç»“æ€§æŠ¥å‘Šï¼ˆæœ¬æ‘˜è¦çš„æ‰©å±•ç‰ˆï¼‰ |

---

## âœ… å¿«é€Ÿæ£€æŸ¥æ¸…å•

### è¯„ä¼°é˜¶æ®µ
- [ ] å®¡é˜…ä¸Šè¿°æŠ€æœ¯æ–‡æ¡£
- [ ] ç¡®è®¤ä¸šåŠ¡éœ€æ±‚ä¼˜å…ˆçº§
- [ ] è¯„ä¼°èµ„æºæŠ•å…¥
- [ ] é£é™©å’Œä¾èµ–å®¡æ ¸

### å‡†å¤‡é˜¶æ®µ
- [ ] ç¯å¢ƒå‡†å¤‡ï¼ˆå¼€å‘/æµ‹è¯•ï¼‰
- [ ] ä¾èµ–åº“é‡‡è´­å’Œå®¡æ ¸
- [ ] å›¢é˜ŸæŠ€æœ¯åŸ¹è®­
- [ ] å¼€å‘å·¥å…·é…ç½®

### å®æ–½é˜¶æ®µ
- [ ] Phase 1ï¼šåŸºç¡€æ¡†æ¶
- [ ] Phase 2-3ï¼šæ ¸å¿ƒæ¸²æŸ“å™¨
- [ ] Phase 4ï¼šé«˜çº§åŠŸèƒ½
- [ ] Phase 5ï¼šä¼˜åŒ–æµ‹è¯•
- [ ] Phase 6ï¼šæ–‡æ¡£å‘å¸ƒ

### éªŒè¯é˜¶æ®µ
- [ ] åŠŸèƒ½éªŒæ”¶æµ‹è¯•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å®‰å…¨å®¡è®¡
- [ ] æ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†

---

## ğŸ¯ é¢„æœŸæˆæœ

### åŠŸèƒ½æ€§
- âœ… æŸ¥çœ‹ Excel/Word/PDF/ZIP æ–‡ä»¶
- âœ… äº®/æš—ä¸»é¢˜é€‚é…
- âœ… æ–‡æ¡£å†…æœç´¢
- âœ… å¯¼å‡ºåŠŸèƒ½

### éåŠŸèƒ½æ€§
- âœ… æ¸²æŸ“æ€§èƒ½è¾¾æ ‡
- âœ… å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- âœ… æµè§ˆå™¨å…¼å®¹æ€§ï¼ˆChrome/Firefox/Edge/Safariï¼‰
- âœ… å®‰å…¨é˜²æŠ¤å®Œå–„

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **å®¡é˜…æ–‡æ¡£**: é˜…è¯» 4 ä»½æŠ€æœ¯æ–‡æ¡£
2. **æŠ€æœ¯è¯„å®¡**: ä¸å›¢é˜Ÿè®¨è®ºæ–¹æ¡ˆå¯è¡Œæ€§
3. **éœ€æ±‚ç¡®è®¤**: æ˜ç¡® P0/P1/P2 åŠŸèƒ½ä¼˜å…ˆçº§
4. **èµ„æºè§„åˆ’**: åˆ†é…å¼€å‘èµ„æº
5. **å¯åŠ¨å®æ–½**: Phase 1 å¼€å§‹

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**åˆ›å»ºæ—¥æœŸ**: 2026-01-22
**æœ€åæ›´æ–°**: 2026-01-22
**ä½œè€…**: Pi Agent åˆ†æå›¢é˜Ÿ
