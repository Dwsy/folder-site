# vscode-office ä¸ Folder-Site èåˆåˆ†ææŠ¥å‘Š

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šåˆ†æäº†å¦‚ä½•å°† **cweijan/vscode-office** çš„ Office æ–‡æ¡£æŸ¥çœ‹èƒ½åŠ›é›†æˆåˆ° **Folder-Site** é¡¹ç›®ä¸­ï¼Œæå‡ºäº†åŸºäºæ’ä»¶ç³»ç»Ÿçš„èåˆæ–¹æ¡ˆã€‚

### æ ¸å¿ƒç»“è®º

âœ… **æ¨èæ–¹æ¡ˆ**: é‡‡ç”¨æ’ä»¶åŒ–æ¶æ„å°† Office æ¸²æŸ“èƒ½åŠ›é›†æˆåˆ° Folder-Site
- ç¬¦åˆç°æœ‰æ’ä»¶ç³»ç»Ÿè®¾è®¡
- ä¿æŒæ¨¡å—åŒ–å’Œå¯ç»´æŠ¤æ€§
- æ”¯æŒç‹¬ç«‹å¯ç”¨/ç¦ç”¨
- æ˜“äºæ‰©å±•æ–°çš„æ–‡æ¡£ç±»å‹

---

## ğŸ¯ èåˆç›®æ ‡

### ä» vscode-office è·å–çš„èƒ½åŠ›

| æ–‡æ¡£ç±»å‹ | æ”¯æŒæ ¼å¼ | æ ¸å¿ƒåº“ | ç¼–è¾‘æ”¯æŒ |
|---------|---------|--------|---------|
| Excel | .xlsx, .xlsm, .xls, .csv, .ods | SheetJS + x-spreadsheet | âœ… |
| Word | .docx, .dotx | docxjs | âŒ |
| PDF | .pdf | pdf.js | âŒ |
| å‹ç¼©åŒ… | .zip, .jar, .rar, .apk | adm-zip, node-unrar-js | âŒ |

### Folder-Site ç°æœ‰èƒ½åŠ›

- âœ… Markdown æ¸²æŸ“ï¼ˆGFMã€æ•°å­¦å…¬å¼ã€Mermaid å›¾è¡¨ï¼‰
- âœ… ä»£ç é«˜äº®ï¼ˆ50+ è¯­è¨€ï¼‰
- âœ… æ’ä»¶ç³»ç»Ÿï¼ˆmermaidã€vegaã€graphvizã€json-canvasï¼‰
- âœ… æ–‡ä»¶æ ‘å¯¼èˆª
- âœ… ä¸»é¢˜åˆ‡æ¢ï¼ˆäº®è‰²/æš—è‰²ï¼‰

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç”¨æˆ·ç•Œé¢å±‚ (FileView)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         æ¸²æŸ“å™¨è·¯ç”±å™¨ (RendererRouter)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       æ’ä»¶ç®¡ç†å™¨ (PluginManager)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚office-rendererâ”‚  â”‚ existing plugins  â”‚  â”‚
â”‚  â”‚  - Excel     â”‚  â”‚  - mermaid         â”‚  â”‚
â”‚  â”‚  - Word      â”‚  â”‚  - vega            â”‚  â”‚
â”‚  â”‚  - PDF       â”‚  â”‚  - graphviz        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       æ ¸å¿ƒåº“å±‚                               â”‚
â”‚  SheetJS  â”‚  docxjs  â”‚  pdf.js  â”‚  adm-zip â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ’ä»¶æ¸…å•ç¤ºä¾‹

```json
{
  "id": "office-renderer",
  "name": "Office Document Renderer",
  "version": "1.0.0",
  "capabilities": [
    {
      "type": "renderer",
      "name": "excel",
      "constraints": {
        "supportedFormats": ["xlsx", "xls", "csv", "ods"],
        "supportsEditing": true
      }
    }
  ]
}
```

---

## ğŸ“¦ ä¾èµ–åˆ†æ

### æ ¸å¿ƒåº“

| åº“ | ç”¨é€” | å¤§å° | è®¸å¯è¯ |
|----|-----|------|--------|
| xlsx | Excel è§£æ | ~500KB | Apache-2.0 |
| docx-preview | Word æ¸²æŸ“ | ~100KB | MIT |
| pdfjs-dist | PDF æ¸²æŸ“ | ~500KB | Apache-2.0 |
| adm-zip | ZIP å¤„ç† | ~50KB | MIT |

**æ€»å¤§å°**: ~1.5MB (gzipped: ~500KB)

### ä¾èµ–ç­–ç•¥

**æ¨è**: æ‡’åŠ è½½ + CDN
- ä»…åœ¨éœ€è¦æ—¶ä¸‹è½½æ¸²æŸ“å™¨
- å¸¸ç”¨æ ¼å¼é¢„åŠ è½½
- ç¨€æœ‰æ ¼å¼æŒ‰éœ€åŠ è½½

---

## ğŸš€ å®æ–½è·¯çº¿å›¾

### Phase 1: åŸºç¡€æ¡†æ¶ï¼ˆç¬¬ 1 å‘¨ï¼‰
- [x] åˆ›å»º `office-renderer` æ’ä»¶ç»“æ„
- [ ] å®ç° Excel æ¸²æŸ“å™¨ï¼ˆåªè¯»ï¼‰
- [ ] æ–‡ä»¶è·¯ç”±é›†æˆ
- [ ] åŸºç¡€ç¼“å­˜æœºåˆ¶

### Phase 2: æ ¸å¿ƒæ¸²æŸ“å™¨ï¼ˆç¬¬ 2-3 å‘¨ï¼‰
- [ ] Word æ¸²æŸ“å™¨
- [ ] PDF æ¸²æŸ“å™¨
- [ ] å‹ç¼©åŒ…æ¸²æŸ“å™¨
- [ ] æ ·å¼é€‚é…

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆç¬¬ 4 å‘¨ï¼‰
- [ ] Excel ç¼–è¾‘
- [ ] æœç´¢å’Œè¿‡æ»¤
- [ ] å¯¼å‡ºåŠŸèƒ½
- [ ] æ‰“å°ä¼˜åŒ–

### Phase 4: ä¼˜åŒ–å’Œæµ‹è¯•ï¼ˆç¬¬ 5 å‘¨ï¼‰
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å¤§æ–‡ä»¶å¤„ç†
- [ ] è·¨æµè§ˆå™¨æµ‹è¯•
- [ ] å®‰å…¨å®¡è®¡

### Phase 5: æ–‡æ¡£å’Œå‘å¸ƒï¼ˆç¬¬ 6 å‘¨ï¼‰
- [ ] ç”¨æˆ·æ–‡æ¡£
- [ ] å¼€å‘è€…æŒ‡å—
- [ ] ç¤ºä¾‹å’Œæ•™ç¨‹
- [ ] ç‰ˆæœ¬å‘å¸ƒ

---

## ğŸ’¡ å¿«é€Ÿå¼€å§‹

### åˆ›å»º Excel æ¸²æŸ“å™¨

```typescript
// plugins/office-renderer/ExcelRenderer.ts
import * as XLSX from 'xlsx';

export class ExcelRenderer implements RendererPlugin {
  name = 'excel';
  extensions = ['.xlsx', '.xls', '.csv', '.ods'];
  version = '1.0.0';

  async render(content: string | ArrayBuffer): Promise<string> {
    const workbook = XLSX.read(content, { type: 'binary' });
    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
    const data = XLSX.utils.sheet_to_json(worksheet);

    // ç”Ÿæˆ HTML è¡¨æ ¼
    return this.renderToHTML(data);
  }
}
```

### æ³¨å†Œæ’ä»¶

```typescript
import { officeRendererPlugin } from './plugins/office-renderer/index.js';

pluginRegistry.register(officeRendererPlugin);
```

### ä½¿ç”¨æ¸²æŸ“å™¨

```typescript
const renderer = pluginRegistry.getRenderer('excel');
const html = await renderer.render(fileContent);
```

è¯¦ç»†æ­¥éª¤è§ [vscode-office-quickstart.md](./vscode-office-quickstart.md)

---

## ğŸ”’ å®‰å…¨è€ƒè™‘

### é£é™©ç¼“è§£

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|-----|------|---------|
| XSS æ”»å‡» | é«˜ | DOMPurify æ¸…ç†ã€CSP ç­–ç•¥ |
| å†…å­˜æº¢å‡º | é«˜ | æ–‡ä»¶å¤§å°é™åˆ¶ã€åˆ†å—æ¸²æŸ“ |
| æ¶æ„æ–‡ä»¶ | ä¸­ | æ–‡ä»¶ç±»å‹éªŒè¯ã€é­”æ•°æ£€æŸ¥ |
| æ€§èƒ½é—®é¢˜ | ä¸­ | ç¼“å­˜ã€æ‡’åŠ è½½ã€è™šæ‹Ÿæ»šåŠ¨ |

### å®‰å…¨å®ç°

```typescript
// HTML æ¸…ç†
import DOMPurify from 'dompurify';

function sanitizeHTML(html: string): string {
  return DOMPurify.sanitize(html, {
    ALLOWED_TAGS: ['table', 'div', 'span', 'tr', 'th', 'td'],
    ALLOWED_ATTR: ['class', 'style'],
  });
}
```

---

## ğŸ“Š æ€§èƒ½é¢„æœŸ

### æ¸²æŸ“æ€§èƒ½ç›®æ ‡

| æ–‡ä»¶å¤§å° | ç›®æ ‡æ—¶é—´ | å®ç°æ–¹å¼ |
|---------|---------|---------|
| < 1MB | < 1s | ç›´æ¥æ¸²æŸ“ |
| 1-10MB | < 3s | ç¼“å­˜ + åˆ†å— |
| 10-50MB | < 10s | æŒ‰é¡µåŠ è½½ã€Web Worker |

### ç¼“å­˜ç­–ç•¥

- **L1 ç¼“å­˜**: å†…å­˜ç¼“å­˜ (LRU, 100MB é™åˆ¶)
- **L2 ç¼“å­˜**: IndexedDB (7å¤©è¿‡æœŸ)
- **é¢„åŠ è½½**: å¸¸ç”¨æ–‡ä»¶æå‰æ¸²æŸ“

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

```typescript
describe('ExcelRenderer', () => {
  it('should render simple spreadsheet', async () => {
    const renderer = new ExcelRenderer();
    const html = await renderer.render(excelData);
    expect(html).toContain('<table');
  });
});
```

### æ€§èƒ½æµ‹è¯•

```typescript
it('should render 1MB file in under 1s', async () => {
  const start = Date.now();
  await renderer.render(largeFile);
  const duration = Date.now() - start;
  expect(duration).toBeLessThan(1000);
});
```

---

## ğŸ“ˆ è´¨é‡æŒ‡æ ‡

### åŠŸèƒ½æ€§æŒ‡æ ‡
- âœ… æ”¯æŒ .xlsx, .xls, .csv, .ods æŸ¥çœ‹
- âœ… æ”¯æŒ .docx, .dotx æŸ¥çœ‹
- âœ… æ”¯æŒ .pdf æŸ¥çœ‹
- âœ… æ”¯æŒ .zip, .rar å†…å®¹æµè§ˆ
- âœ… Excel ç¼–è¾‘ï¼ˆå¯é€‰ï¼‰

### éåŠŸèƒ½æ€§æŒ‡æ ‡
- æ€§èƒ½ï¼šå°æ–‡ä»¶ <1sï¼Œä¸­æ–‡ä»¶ <3s
- å…¼å®¹æ€§ï¼šChrome/Firefox/Edge/Safari
- å¯è®¿é—®æ€§ï¼šWCAG 2.1 AA
- å®‰å…¨æ€§ï¼šOWASP Top 10 é˜²æŠ¤

---

## ğŸ¨ ç”¨æˆ·ä½“éªŒ

### æ¸²æŸ“æ•ˆæœ

```typescript
// è‡ªåŠ¨ä¸»é¢˜é€‚é…
const theme = useTheme();
const options = {
  theme: theme === 'dark' ? 'dark' : 'light',
  showGridLines: true,
};
```

### åŠŸèƒ½ç‰¹æ€§

- ğŸ“‘ å¤šå·¥ä½œè¡¨æ ‡ç­¾é¡µ
- ğŸ¨ äº®è‰²/æš—è‰²ä¸»é¢˜
- ğŸ” æ–‡æ¡£å†…æœç´¢
- ğŸ“¥ å¯¼å‡ºä¸º PDF/å›¾ç‰‡
- âŒ¨ï¸ é”®ç›˜å¿«æ·é”®

---

## ğŸ“š äº¤ä»˜ç‰©

### æ–‡æ¡£æ¸…å•

| æ–‡æ¡£ | æè¿° | çŠ¶æ€ |
|-----|------|------|
| [èåˆæ–¹æ¡ˆåˆ†æ](./vscode-office-integration-analysis.md) | å®Œæ•´çš„æŠ€æœ¯åˆ†æå’Œæ–¹æ¡ˆè®¾è®¡ | âœ… å®Œæˆ |
| [æ¶æ„è®¾è®¡](./vscode-office-integration-architecture.md) | è¯¦ç»†æ¶æ„å›¾å’Œç»„ä»¶è®¾è®¡ | âœ… å®Œæˆ |
| [å¿«é€Ÿå…¥é—¨](./vscode-office-quickstart.md) | åˆ†æ­¥å®ç°æŒ‡å— | âœ… å®Œæˆ |
| æœ¬æŠ¥å‘Š | æ€»ç»“æ€§æŠ¥å‘Š | âœ… å®Œæˆ |

### ä»£ç ç¤ºä¾‹

- âœ… ExcelRenderer å®Œæ•´å®ç°
- âœ… æ’ä»¶æ¸…å•ç¤ºä¾‹
- âœ… FileView é›†æˆä»£ç 
- âœ… API ç«¯ç‚¹å®ç°
- âœ… æ ·å¼å®šä¹‰

---

## ğŸ”® æœªæ¥æ‰©å±•

### çŸ­æœŸï¼ˆPhase 1-5ï¼‰
- Excel ç¼–è¾‘åŠŸèƒ½
- PDF åˆ†é¡µå¯¼èˆª
- æ–‡æ¡£å†…æœç´¢
- æ‰¹é‡å¯¼å‡º

### ä¸­æœŸï¼ˆPhase 6+ï¼‰
- OCR/å›¾ç‰‡è½¬æ–‡å­—
- åä½œç¼–è¾‘
- ç‰ˆæœ¬å†å²
- äº‘ç«¯åŒæ­¥

### é•¿æœŸæ„¿æ™¯
- AI è¾…åŠ©ç¼–è¾‘
- å®æ—¶åä½œ
- å¤šæ ¼å¼äº’æ“ä½œ
- ç§»åŠ¨åº”ç”¨

---

## âœ… ç»“è®ºä¸å»ºè®®

### æ ¸å¿ƒå»ºè®®

1. **é‡‡ç”¨æ’ä»¶åŒ–æ¶æ„**
   - ä¿æŒ Folder-Site çš„æ¨¡å—åŒ–è®¾è®¡
   - Office æ¸²æŸ“å™¨ç‹¬ç«‹ä¸º `office-renderer` æ’ä»¶
   - æ”¯æŒç‹¬ç«‹æ›´æ–°å’Œç‰ˆæœ¬ç®¡ç†

2. **ä¼˜å…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½**
   - P0: Excelã€Wordã€PDF æŸ¥çœ‹å™¨
   - P1: å‹ç¼©åŒ…æµè§ˆã€ç¼“å­˜ä¼˜åŒ–
   - P2: Excel ç¼–è¾‘ã€é«˜çº§å¯¼å‡º

3. **æ¸è¿›å¼å®æ–½**
   - ä» Excel æ¸²æŸ“å™¨å¼€å§‹ï¼ˆæŠ€æœ¯é£é™©æœ€ä½ï¼‰
   - é€æ­¥æ·»åŠ å…¶ä»–æ ¼å¼
   - è¿­ä»£ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ

4. **å®‰å…¨ç¬¬ä¸€**
   - ä¸¥æ ¼çš„è¾“å…¥éªŒè¯
   - XSS é˜²æŠ¤ï¼ˆDOMPurifyï¼‰
   - æ–‡ä»¶å¤§å°é™åˆ¶
   - CSP ç­–ç•¥

### æˆåŠŸæ ‡å‡†

- âœ… æ»¡è¶³ Phase 1-5 åŠŸèƒ½éœ€æ±‚
- âœ… æ€§èƒ½è¾¾åˆ°é¢„æœŸæŒ‡æ ‡
- âœ… é€šè¿‡å®‰å…¨å®¡è®¡
- âœ… æ–‡æ¡£å®Œæ•´
- âœ… ç”¨æˆ·ä½“éªŒæµç•…

---

## ğŸ“ è”ç³»å’Œåé¦ˆ

å¦‚æœ‰ç–‘é—®æˆ–å»ºè®®ï¼Œè¯·å‚è€ƒï¼š
- æŠ€æœ¯è®¨è®º: [GitHub Issues](https://github.com/your-repo/issues)
- æ–‡æ¡£æ›´æ–°: [docs/](./)
- å®æ–½æ”¯æŒ: å¼€å‘å›¢é˜Ÿ

---

**æŠ¥å‘Šæ—¥æœŸ**: åŸºäºå½“å‰çš„ DeepWikiåˆ†æå’Œç°æœ‰ä»£ç åº“
**é¡¹ç›®çŠ¶æ€**: è®¾è®¡é˜¶æ®µï¼Œå¾…å®æ–½å®¡æ‰¹
**é¢„æœŸäº¤ä»˜**: 6å‘¨åï¼ˆæŒ‰è·¯çº¿å›¾æ‰§è¡Œï¼‰
