---
id: "20260123-设计: 分析项目欠缺的"
title: "设计: 分析项目欠缺的功能和改进点"
status: "in-progress"
created: "2026-01-23"
updated: "2026-01-23"
category: "design"
tags: ["分析", "gap-analysis", "改进"]
---

# Issue: 设计: 分析项目欠缺的功能和改进点

## Goal

全面分析 Folder-Site CLI 项目当前实现状态，识别欠缺的功能、潜在改进点和未来发展方向，为下一阶段的开发提供明确路线图。

## 背景/问题

项目已完成 v1.0.0 版本，实现了核心功能（CLI、文件浏览、Markdown 渲染、搜索、插件系统、Workhub 集成）。但在实际使用和代码审查中发现以下问题：

1. **功能完整性**：某些设计文档中规划的功能未完全实现
2. **用户体验**：部分 UI/UX 细节需要优化
3. **性能优化**：存在进一步优化的空间
4. **文档完善**：部分功能文档不够详细
5. **测试覆盖**：某些边缘情况测试不足

## 验收标准 (Acceptance Criteria)

- [ ] WHEN 分析完成，系统 SHALL 输出完整的功能差距清单
- [ ] WHERE 发现缺失功能，系统 SHALL 分类为：缺失/不完整/待优化
- [ ] IF 发现技术债务，系统 SHALL 提供重构建议和优先级

## 实施阶段

### Phase 1: 代码库分析 ✅
- [x] 使用 ace-tool 研究现有代码结构
- [x] 阅读设计文档和完成报告
- [x] 识别已实现 vs 未实现功能

### Phase 2: 功能差距分析 🚧
- [ ] 核心功能差距分析
- [ ] 插件系统差距分析
- [ ] Workhub 集成差距分析
- [ ] 性能优化差距分析

### Phase 3: 改进建议 📋
- [ ] 功能增强建议
- [ ] 技术债务清理
- [ ] 用户体验优化
- [ ] 文档完善计划

### Phase 4: 优先级排序 🎯
- [ ] 按影响程度排序
- [ ] 按实现难度排序
- [ ] 制定实施路线图

## 关键决策

| 决策 | 理由 |
|------|------|
| 分类维度 | 按功能/性能/UX/文档四个维度分类 |
| 优先级标准 | 高：影响核心功能；中：提升体验；低：锦上添花 |
| 实施策略 | 先补齐核心差距，再优化体验 |

## 分析结果

### 1. 核心功能差距

#### 1.1 文件监听和热更新
**状态**: ⚠️ 部分实现
**问题描述**:
- `src/server/services/watcher.ts` 已实现基础文件监听
- 但缺少完整的 WebSocket 实时通知机制
- 客户端需要手动刷新才能看到变更

**影响**: 中
**改进建议**:
```typescript
// 需要添加 WebSocket 服务
- 实现 Hono WebSocket 升级
- 文件变更时推送事件到客户端
- 客户端自动刷新或显示变更提示
```

#### 1.2 文件索引优化
**状态**: ⚠️ 部分实现
**问题描述**:
- 使用 fuse.js 实现模糊搜索
- 缺少增量索引更新机制
- 大型项目索引重建耗时

**影响**: 中
**改进建议**:
```typescript
// 需要添加增量索引更新
- 监听文件变更，只更新受影响的索引
- 实现索引持久化（避免每次重启重建）
- 添加索引进度提示
```

#### 1.3 Markdown 渲染增强
**状态**: ⚠️ 部分实现
**问题描述**:
- 基础 Markdown 渲染已实现
- 缺少某些高级特性：
  - 自定义容器（callout、admonition）
  - 脚注支持
  - 任务列表交互（可点击勾选）
  - 图片缩放和画廊

**影响**: 低
**改进建议**:
```typescript
// 添加 remark 插件
- remark-callout 或自定义容器插件
- remark-footnotes
- remark-task-list (交互式)
- 实现图片画廊组件
```

### 2. 插件系统差距

#### 2.1 插件架构完整性
**状态**: ✅ 已实现
**问题**: 架构完整，但缺少示例和文档
**改进建议**:
- 添加更多插件示例（Vega、JSON Canvas 已有）
- 编写详细的插件开发教程
- 提供插件脚手架工具

#### 2.2 插件市场
**状态**: ❌ 未实现
**问题描述**:
- 插件只能通过 npm 安装或本地开发
- 缺少插件发现和分享机制

**影响**: 低
**改进建议**:
```typescript
// 可选功能：插件市场
- 创建插件仓库（GitHub 组织）
- 实现插件列表 API
- 提供插件安装 CLI 命令
```

### 3. Workhub 集成差距

#### 3.1 Workhub 编辑功能
**状态**: ❌ 未实现
**问题描述**:
- 当前只能读取 docs/ 结构
- 无法创建/编辑 Issue、ADR、PR

**影响**: 中
**改进建议**:
```typescript
// 添加 Workhub 编辑功能
- 实现 Issue 创建/编辑表单
- 实现 ADR 创建/编辑表单
- 实现 PR 创建/编辑表单
- 添加文件自动保存机制
```

#### 3.2 Workhub 协作功能
**状态**: ❌ 未实现
**问题描述**:
- 缺少评论系统
- 缺少标签管理
- 缺少指派功能

**影响**: 低
**改进建议**:
```typescript
// 添加协作功能
- 实现评论系统（本地存储）
- 实现标签管理
- 实现指派功能
```

### 4. 性能优化差距

#### 4.1 渲染性能
**状态**: ⚠️ 部分实现
**问题描述**:
- 已实现 LRU 缓存
- 大文件渲染仍可能卡顿
- 缺少虚拟滚动

**影响**: 中
**改进建议**:
```typescript
// 添加虚拟滚动
- 使用 @tanstack/react-virtual
- 实现长文档分块渲染
- 添加懒加载图片
```

#### 4.2 搜索性能
**状态**: ✅ 已优化
**问题**: 已有 LRU 缓存和性能追踪
**改进建议**:
- 添加搜索历史记录
- 实现搜索结果高亮优化

### 5. 用户体验差距

#### 5.1 键盘快捷键
**状态**: ⚠️ 部分实现
**问题描述**:
- 已实现 Cmd+P（搜索）、Cmd+D（主题切换）
- 缺少其他常用快捷键：
  - Cmd+S（保存）
  - Cmd+/（显示快捷键帮助）
  - Cmd+K（命令面板）
  - Cmd+Shift+F（全局搜索）

**影响**: 低
**改进建议**:
```typescript
// 扩展键盘快捷键
- 添加命令面板（Cmd+K）
- 添加快捷键帮助模态框
- 实现快捷键自定义配置
```

#### 5.2 移动端适配
**状态**: ⚠️ 部分实现
**问题描述**:
- 已有响应式布局
- 移动端触摸体验不佳
- 缺少移动端专用组件

**影响**: 低
**改进建议**:
```typescript
// 优化移动端体验
- 实现移动端侧边栏抽屉
- 优化触摸手势（滑动导航）
- 添加移动端搜索按钮
```

#### 5.3 主题系统
**状态**: ✅ 已实现
**问题**: Light/Dark/Auto 三种模式完整
**改进建议**:
- 添加自定义颜色主题
- 添加代码主题选择
- 支持用户主题配置

### 6. 文档差距

#### 6.1 API 文档 ✅ 已完成
**状态**: ✅ 已完成 (2026-01-23)
**问题描述**:
- `docs/API.md` 存在但不够详细
- 缺少 OpenAPI/Swagger 规范

**影响**: 中
**改进建议**:
```typescript
// 完善 API 文档
- 使用 Swagger/OpenAPI 规范
- 添加 API 测试界面
- 提供 Postman Collection
```

**完成内容**:
- ✅ 重写完整的 API 文档（30KB+）
- ✅ 包含所有端点的详细说明
- ✅ 添加请求/响应示例
- ✅ 包含错误处理和最佳实践
- ✅ 提供代码示例和类型定义

#### 6.2 插件开发文档 ✅ 已完成
**状态**: ✅ 已完成 (2026-01-23)
**问题描述**:
- `docs/PLUGIN_API.md` 和 `docs/PLUGIN_DEVELOPMENT.md` 存在
- 缺少完整示例教程

**影响**: 中
**改进建议**:
```markdown
# 添加插件开发教程
- 从零开始的插件教程
- 常见插件模式示例
- 插件调试指南
- 插件发布指南
```

**完成内容**:
- ✅ 编写完整的插件开发教程（80KB+）
- ✅ 从零开始的 Hello World 示例
- ✅ 常见插件模式（渲染器、导出器、UI）
- ✅ 调试指南和测试指南
- ✅ 发布指南和最佳实践
- ✅ 完整的 API 详解和类型定义

#### 6.3 迁移指南 ✅ 已完成
**状态**: ✅ 已完成 (2026-01-23)
**问题描述**:
- 缺少从其他工具迁移的指南
  - MkDocs
  - Docusaurus
  - Jekyll
  - Hugo

**影响**: 低
**改进建议**:
```markdown
# 添加迁移指南
- MkDocs → Folder-Site
- Docusaurus → Folder-Site
- 配置文件转换工具
```

**完成内容**:
- ✅ 编写完整的迁移指南（33KB+）
- ✅ MkDocs → Folder-Site 迁移步骤
- ✅ Docusaurus → Folder-Site 迁移步骤
- ✅ Jekyll → Folder-Site 迁移步骤
- ✅ Hugo → Folder-Site 迁移步骤
- ✅ 配置文件对比和转换示例
- ✅ 目录结构调整建议

### 7. 测试差距

#### 7.1 E2E 测试
**状态**: ✅ 已实现
**问题**: 已有基础 E2E 测试
**改进建议**:
- 添加更多用户场景测试
- 添加跨浏览器测试

#### 7.2 性能测试
**状态**: ❌ 未实现
**问题描述**:
- 缺少性能基准测试
- 缺少负载测试

**影响**: 低
**改进建议**:
```typescript
// 添加性能测试
- 使用 k6 进行负载测试
- 实现性能基准测试
- 添加 CI 性能回归检测
```

### 8. 开发体验差距

#### 8.1 开发工具
**状态**: ⚠️ 部分实现
**问题描述**:
- 已有基础开发脚本
- 缺少开发辅助工具：
  - 代码生成器（组件、插件模板）
  - 调试工具
  - 性能分析工具

**影响**: 低
**改进建议**:
```bash
# 添加开发工具脚本
bun run dev:component  # 生成组件模板
bun run dev:plugin     # 生成插件模板
bun run dev:debug      # 启动调试模式
```

#### 8.2 CI/CD
**状态**: ❌ 未实现
**问题描述**:
- 缺少 GitHub Actions 配置
- 缺少自动化测试和发布流程

**影响**: 中
**改进建议**:
```yaml
# 添加 GitHub Actions
- 自动化测试
- 代码质量检查（ESLint、Prettier）
- 自动化发布（npm、GitHub Release）
```

## 优先级排序

### 高优先级（影响核心功能）

| 编号 | 功能 | 影响 | 难度 | 预计工时 | 状态 |
|------|------|------|------|----------|------|
| 1 | WebSocket 实时通知 | 高 | 中 | 4h | ⏳ 待开始 |
| 2 | 增量文件索引 | 高 | 中 | 3h | ✅ 已完成 |
| 3 | Workhub 编辑功能 | 中 | 高 | 8h | ⏳ 待开始 |
| 4 | API 文档完善 | 中 | 低 | 2h | ✅ 已完成 |

### 中优先级（提升体验）

| 编号 | 功能 | 影响 | 难度 | 预计工时 | 状态 |
|------|------|------|------|----------|------|
| 5 | 虚拟滚动 | 中 | 中 | 6h | ✅ 已完成 |
| 6 | 命令面板 | 低 | 低 | 2h | ⏳ 待开始 |
| 7 | 插件开发教程 | 中 | 低 | 3h | ✅ 已完成 |
| 8 | CI/CD 配置 | 中 | 低 | 3h | ⏳ 待开始 |

### 低优先级（锦上添花）

| 编号 | 功能 | 影响 | 难度 | 预计工时 | 状态 |
|------|------|------|------|----------|------|
| 9 | Markdown 高级特性 | 低 | 低 | 4h | ⏳ 待开始 |
| 10 | 插件市场 | 低 | 高 | 12h | ⏳ 待开始 |
| 11 | 移动端优化 | 低 | 中 | 6h | ✅ 已完成 |
| 12 | 迁移指南 | 低 | 低 | 3h | ✅ 已完成 |
| 13 | 性能测试 | 低 | 中 | 4h | ⏳ 待开始 |

### 进度统计

- **已完成**: 6/13 (46%)
- **待开始**: 7/13 (54%)
- **已完成工时**: 23h
- **剩余工时**: 33h

## 实施路线图

### Sprint 1: 核心功能增强（1-2周）
- [ ] WebSocket 实时通知
- [x] 增量文件索引 ✅ (2026-01-23)
- [x] API 文档完善 ✅ (2026-01-23)

### Sprint 2: Workhub 完善（1周）
- [ ] Workhub 编辑功能
- [ ] 评论系统
- [ ] 标签管理

### Sprint 3: 体验优化（1周）
- [x] 虚拟滚动 ✅ (2026-01-23)
- [ ] 命令面板
- [ ] 键盘快捷键扩展

### Sprint 4: 开发体验（1周）
- [x] 插件开发教程 ✅ (2026-01-23)
- [ ] CI/CD 配置
- [ ] 开发工具脚本

### Sprint 5: 持续改进（按需）
- [ ] Markdown 高级特性
- [x] 移动端优化 ✅ (2026-01-23)
- [x] 迁移指南 ✅ (2026-01-23)
- [ ] 性能测试

## 遇到的错误

| 日期 | 错误 | 解决方案 |
|------|------|---------|
| 2026-01-23 | system-design skill 无 lib.ts | 发现 skill 仅提供方法论，无需脚本执行 |

## 相关资源

- [x] 相关文档: `docs/design-catalog/requirements.md`
- [x] 相关文档: `docs/design-catalog/big-picture.mmd`
- [x] 相关文档: `docs/reports/PROJECT_COMPLETION_REPORT_FINAL.md`
- [x] 相关文档: `docs/notes/DEVELOPMENT_STATUS.md`
- [ ] 相关 Issue: `docs/issues/20260123-设计: 分析项目欠缺的.md` (当前)

## Notes

### 研究过程

1. **Phase 1**: 使用 ace-tool 探索现有代码库
   - 分析了项目结构（cli、server、client、plugins）
   - 识别了已实现的核心功能
   - 查看了设计文档和完成报告

2. **Phase 2**: 功能差距识别
   - 对比设计文档和实际实现
   - 识别未实现或不完整的功能
   - 分类整理为8个维度

3. **Phase 3**: 优先级评估
   - 按影响程度和实现难度排序
   - 制定5个Sprint的实施路线图

### 关键发现

**已完成的核心功能**：
- ✅ CLI 参数解析和启动
- ✅ Hono 服务器和中间件
- ✅ 文件扫描和索引
- ✅ Markdown 渲染和代码高亮
- ✅ 搜索功能（模糊搜索 + 缓存）
- ✅ 主题系统（Light/Dark/Auto）
- ✅ 插件架构和加载器
- ✅ Mermaid 和 Graphviz 渲染器
- ✅ Workhub 集成（只读）
- ✅ PDF/HTML 导出
- ✅ 错误处理和缓存

**主要差距**：
1. **实时性**：缺少 WebSocket 通知，需要手动刷新
2. **编辑能力**：Workhub 只读，无法创建/编辑内容
3. **性能优化**：缺少虚拟滚动，大文件渲染可能卡顿
4. **开发体验**：缺少 CI/CD、开发工具和详细文档

### 待确认事项

- [ ] 是否需要实现 Workhub 双向编辑功能？
- [ ] 是否需要开发插件市场？
- [ ] 移动端优化的优先级是否应该提高？
- [ ] 是否需要支持更多 Markdown 高级特性？

---

## Status 更新日志

- **[2026-01-23 22:21]**: 状态变更 → in-progress，备注: 开始分析，使用 ace-tool 研究代码库
- **[2026-01-23 22:21]**: 分析完成，输出完整的功能差距清单和实施路线图
- **[2026-01-23 09:26]**: ✅ API 文档完善完成，生成 30KB+ 完整 API 文档
- **[2026-01-23 09:31]**: ✅ 揽件开发教程完成，生成 80KB+ 详细教程
- **[2026-01-23 09:31]**: ✅ 迁移指南完成，生成 33KB+ 迁移指南
- **[2026-01-23 09:31]**: 进度更新 → 3/13 任务完成 (23%)，文档类任务全部完成
- **[2026-01-23 09:37]**: ✅ 移动端优化完成，实现触摸手势、搜索按钮、底部导航栏
- **[2026-01-23 09:37]**: 进度更新 → 4/13 任务完成 (31%)
- **[2026-01-23 09:50]**: ✅ 虚拟滚动完成，实现虚拟滚动 Hook 和虚拟 Markdown 渲染器
- **[2026-01-23 09:50]**: 进度更新 → 5/13 任务完成 (38%)
- **[2026-01-23 10:00]**: ✅ 增量文件索引完成，实现索引持久化、增量更新和文件监视
- **[2026-01-23 10:00]**: 进度更新 → 6/13 任务完成 (46%)